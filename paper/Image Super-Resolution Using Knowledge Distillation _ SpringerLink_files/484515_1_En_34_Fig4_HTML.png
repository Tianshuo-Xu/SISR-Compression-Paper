<!DOCTYPE html>
<html lang="zh-cmn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>厦门大学VPN登入</title>
    
    <meta name="keywords"
          content="厦门大学VPN,厦门大学WebVPN,厦门大学内网访问,厦门大学访问控制,厦门大学内网登录,厦门大学资源访问控制系统,WebVPN,WEBVPN,VPN,clientless vpn,网瑞达,北京网瑞达科技有限公司,资源访问控制系统,访问控制,堡垒机,SSLVPN,CASB,认证,成都网瑞达科技有限公司,图书馆认证,图书馆统计,图书馆下载分析,电子资源访问控制,论文下载,访问,图书馆"/>
    
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit">
    <link rel="stylesheet" href="/wengine-vpn/js/css/normalize.css"/>
    <link rel="stylesheet" href="/wengine-vpn/js/css/login.css?v=20200501"/>
    <link rel="stylesheet" href="/wengine-vpn/js/layui/css/layui.css">
    <link rel="stylesheet" href="/wengine-vpn/js/css/quill.snow.css">
    <script src="/wengine-vpn/js/js/wechat-font.js"></script>
    <style>
        #captcha-wrap{
            display:none;
        }
        #error-message{
            display: none;
        }
        body {
            -webkit-text-size-adjust: 100% !important;
        }
    </style>
</head>
<body>
<div class="background">
</div>
<div class="main">
    <div class="header">
        
            <div class="portal-logo">
                <img style="height:100%" src="/wengine-vpn/js/image/logo.png"/>
            </div>
            <div class="portal-title">
                <span style="line-height: 48px;">厦门大学VPN登入</span>
            </div>
        
    </div>
    <div class="container">
        <div class="notice-panel">
            <div class="notice-box">
                <div class="notice-title">
                    通知
                </div>
                <div class="notice-break-line"></div>
                <div class="notice-content">
                    <div class="ql-snow">
                        <div id="ql-editor" class="ql-editor">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="login-panel">
            <div class="login-box">
                
                
                

                <div class="login-nav-header">
                    <div class="login-nav-wrap">
                        <span class="login-nav-prev"><i class="layui-icon layui-icon-left"></i></span>
                        <span class="login-nav-next"><i class="layui-icon layui-icon-right"></i></span>
                        <div class="login-nav-scroll">
                            <div class="login-nav-nav">
                                
                                    
                                    <div class="login-nav-item" data-type="auth_web_wechat" id="auth_web_wechat">企业微信</div>
                                    
                                
                                    
                                    <div class="login-nav-item" data-type="local" id="local">账号登录</div>
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                                    
                                
                            </div>
                            
                        </div>
                    </div>
                </div>

                
                    <form class="el-form el-form--label-top" id="form">
                        <input name="auth_type" type="hidden" value="local"/>
                        
                        
                            <div class="login-form-item">
                                <div class="el-input user-input">
                                    <input autocomplete="new-password" id="user_name" placeholder="学工号(CampusID)"
                                           type="text" name="username">
                                </div>
                            </div>
                        

                        <div class="login-form-item sms-field" style="display:none;">
                            <div class="el-input phone-code-input">
                                <input autocomplete="new-code" placeholder="验证码" type="text" name="sms_code"
                                       id="phone-code-input" style="flex:1">
                                <div class="send-sms" id="send-sms">点击发送</div>
                                <img id="help_mark" class="help-mark sms-wx-field"
                                     src="/wengine-vpn/js/image/question-mark.png"/>
                            </div>
                        </div>

                        
                            <div class="login-form-item password-field">
                                <div class="el-input password-input">
                                    <input autocomplete="new-password" placeholder="密码" type="password" name="password">
                                </div>
                            </div>
                        
                        <div class="login-form-item password-field" id="captcha-wrap">
                            <div class="el-input code-input">
                                <input autocomplete="new-code" placeholder="验证码" type="text" name="captcha" style="flex:1">
                                <input type="hidden" name="needCaptcha" value="false">
                                <div class="captcha-div">
                                    <input type="hidden" name="captcha_id" value="f67l4ShfcqhJYnT">
	<a class="captcha" href="javascript:" tabindex="-1">
		<img onclick="this.src=('/captcha/f67l4ShfcqhJYnT.png?reload='+(new Date()).getTime())" class="captcha-img" src="/captcha/f67l4ShfcqhJYnT.png">
	</a>
                                </div>
                            </div>
                        </div>

                        <div class="upper-login-field">
                            <div class="msg" id="error-message">
                            </div>
                            
                                <div class="remember-field">
                                    <input type="checkbox" name="remember_cookie" style="vertical-align: middle;"></span>
                                    <span>下次自动登录</span>
                                </div>
                            
                        </div>
                        
                        <div class="wechat-qrcode" style="margin-top: 20px">
                            <div id="wechat-qrcode"></div>
                        </div>
                        

                        

                        
                        
                        
                        

                        
                            <button type="button" class="el-button-login" style="margin-bottom:20px;" id="login">
                                <span>登录</span>
                            </button>
                        
                    </form>
                    <div class="mobile-notice-panel">
                        <div class="notice-box">
                            <div class="notice-break-line"></div>
                            <div class="notice-title">
                                通知
                            </div>
                            <div class="notice-content">
                                <div class="ql-snow">
                                    <div id="mobile-ql-editor" class="ql-editor">
            
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="wechat_tip" style="display:none;padding:10px">
                <div style="font-size:16px">1. 请先扫描二维码并关注该服务公众号</div>
                <img src="/wengine-vpn/js/image/wx.png" style="width:120px;height:120px;margin-left:15px;"/>
                <div style="font-size:16px">2. 进入公众号点击”用户认证“进行认证</div>
            </div>
        </div>
        <div class="footer" style="text-align: center;margin-top: 20px;margin-bottom: 10px;">
            厦门大学 2020 © 网瑞达科技
        </div>
    </div>
    <div class="second-login-layer" id="second_login_layer" style="display:none">
        <div class="layer-form-title">
            双重登录认证
        </div>
        <form id="second_login_form" class="layui-form">
            <input type="hidden" name="username" autocomplete="off" id="twostep-username">
            <div class="layui-form-item">
                <label class="layui-form-label">手机号</label>
                <div class="layui-input-block">
                    <input type="text" name="disable_phone" autocomplete="off" disabled class="layui-input"
                           id="twostep-phone" style="border:none">
                </div>
            </div>
            <div class="layui-form-item">
                <div class="layui-inline">
                    <label class="layui-form-label">验证码</label>
                    <div class="layui-input-inline" style="width:160px;">
                        <input type="text" name="code" autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <div class="layui-input-inline" style="width:60px;">
                        <div class="layui-btn layui-btn-mormal" id="send-phone-sms" style="background:#1B9EF3;">获取验证码</div>
                    </div>
                </div>
            </div>
            <div>
                <input type="button" id="submit_second_login" class="layui-btn layui-btn-mormal"
                       style="background:#1B9EF3;float:right" value="继续登录"/>
            </div>

        </form>
    </div>

    <script type="text/javascript" src="/wengine-vpn/js/js/jquery.min.js"></script>
    <script type="text/javascript" src="/wengine-vpn/js/layer-v3.1.1/layer.js"></script>
    <script type="text/javascript" src="/wengine-vpn/js/layui/layui.js"></script>
    
    
    <script type="text/javascript" src="//rescdn.qqmail.com/node/ww/wwopenmng/js/sso/wwLogin-1.0.0.js"></script>
    
    

    <script type="text/javascript">
        
        $("#ql-editor").html("\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e为了方便您在外网访问内网和图书馆资源，开通了新版VPN，无需客户端安装支持电脑和手机直接使用，为了获得更好的体验建议使用Chrome、Firefox、IE11、Edge、Safari等浏览器。\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e1、用户名为您的学号或者教工号，密码与校园Wifi或VPN密码相同；\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e2、如多次密码错误被锁定，请等待15分钟后再重试。如忘记密码，请访问 \u003c/span\u003e\u003ca href=\"http://pass.xmu.edu.cn/\" target=\"_blank\" class=\"ql-size-large\"\u003epass.xmu.edu.cn\u003c/a\u003e\u003cspan class=\"ql-size-large\"\u003e 进行重置；\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e3、本系统仅限于访问首页列表中的网站资源。\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003eIn order to facilitate your access to intranet and library resources on the Internet, a new version of VPN has been opened, which can be used directly without client installation and support of computers and mobile phones. In order to get a better experience, it is recommended to use chrome, Firefox, ie11, edge, Safari and other browsers.\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e1. The user name is your student number or teaching staff number, and the password is the same as the campus WiFi or VPN password;\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e2. If more than one password error is locked, please wait 15 minutes and try again. If you forget your password, please visit \u003c/span\u003e\u003ca href=\"http://pass.xmu.edu.cn\" target=\"_blank\" class=\"ql-size-large\"\u003epass.xmu.edu.cn\u003c/a\u003e\u003cspan class=\"ql-size-large\"\u003e to reset it;\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e3. This system is limited to visiting the website resources in the homepage list.\u003c/span\u003e\u003c/h6\u003e\u003ch4\u003e\u003cbr\u003e\u003c/h4\u003e");
        $("#mobile-ql-editor").html("\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e为了方便您在外网访问内网和图书馆资源，开通了新版VPN，无需客户端安装支持电脑和手机直接使用，为了获得更好的体验建议使用Chrome、Firefox、IE11、Edge、Safari等浏览器。\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e1、用户名为您的学号或者教工号，密码与校园Wifi或VPN密码相同；\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e2、如多次密码错误被锁定，请等待15分钟后再重试。如忘记密码，请访问 \u003c/span\u003e\u003ca href=\"http://pass.xmu.edu.cn/\" target=\"_blank\" class=\"ql-size-large\"\u003epass.xmu.edu.cn\u003c/a\u003e\u003cspan class=\"ql-size-large\"\u003e 进行重置；\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e3、本系统仅限于访问首页列表中的网站资源。\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003eIn order to facilitate your access to intranet and library resources on the Internet, a new version of VPN has been opened, which can be used directly without client installation and support of computers and mobile phones. In order to get a better experience, it is recommended to use chrome, Firefox, ie11, edge, Safari and other browsers.\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e1. The user name is your student number or teaching staff number, and the password is the same as the campus WiFi or VPN password;\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e2. If more than one password error is locked, please wait 15 minutes and try again. If you forget your password, please visit \u003c/span\u003e\u003ca href=\"http://pass.xmu.edu.cn\" target=\"_blank\" class=\"ql-size-large\"\u003epass.xmu.edu.cn\u003c/a\u003e\u003cspan class=\"ql-size-large\"\u003e to reset it;\u003c/span\u003e\u003c/h6\u003e\u003ch6\u003e\u003cspan class=\"ql-size-large\"\u003e3. This system is limited to visiting the website resources in the homepage list.\u003c/span\u003e\u003c/h6\u003e\u003ch4\u003e\u003cbr\u003e\u003c/h4\u003e");

        var logoutByOther = ''
        if (logoutByOther != "") {
            layer.msg("您的账号已经在其他地点登录，请检查账号密码是否泄漏");
        }

        var logoutByIpChange = ''
        if (logoutByIpChange != "") {
            layer.msg("您的账号IP发生变化，请重新登录");
        }

        var errorMessage = ''
        if (errorMessage != "") {
            layer.msg(errorMessage)
        }

        var hasError = logoutByOther == "" && errorMessage == "" && logoutByIpChange == "";

        var sec;
        var intervalId = 0;
        $(function () {
            $('#user_name').focus();
            $('form#form input').on('keyup', function(e){
                if(e.keyCode == 13){
                    $('#login').trigger('click');
                }
            });
            $('#login').click(function() {
                var data = $('#form').serializeArray()
                $("#error-message").hide()
                $('#twostep-phone').val("")
                $('#twostep-phone2').val("")
                $('#twostep-username').val("")
                
                $.post('/do-login', data, function(res) {
                    if (res.success) {
                        location.href = res.url
                    }else{
                        switch (res.error) {
                            case "IP_FORBIDDEN":
                            case "CAPTCHA_FAILED":
                            case "TOO_MANY_ATTEMPTS":
                            case "WEEK_PASSWORD_FORBID":
                            case "INVALID_ACCOUNT":
                                $(".captcha img").trigger('click');
                                $("#captcha-wrap").show();

                                $("#error-message").show();
                                $("#error-message").html(res.message)
                                return;
                            case "NEED_CONFIRM":
                                layer.confirm('该账号已经登录，继续登录将踢掉其他已登录账号', {
                                    btn: ['继续', '取消']
                                }, function () {
                                    $.ajax({
                                        url: "/do-confirm-login",
                                        dataType: 'json',
                                        type: 'POST',
                                        success: function (res) {
                                            if (res.success) {
                                                layer.msg("登录成功！");
                                                setTimeout(function () {
                                                    window.location.href = res.url
                                                }, 1000);
                                            } else {
                                                layer.msg(res.url);
                                            }
                                        }
                                    })
                                });
                                return;
                            case "NEED_TWO_STEP":
                                $('input[name="disable_phone"]').val(res.phone);
                                layer.open({
                                    type: 1,
                                    shade: 0.3,
                                    title: false,
                                    shadeClose: true,
                                    closeBtn: 1,
                                    scrollbar: false,
                                    offset: '350px',
                                    area: "460px",
                                    content: $('#second_login_layer')
                                });
                                return;
                            case "WEEK_PASSWORD_CHECK":
                                layer.open({
                                    content: res.message,
                                    btn: ['确认'],
                                    yes: function () {
                                        location.href = res.url
                                    },
                                    cancel: function(){
                                        location.href = res.url
                                        return false;
                                    }
                                });
                                return;
                            case "INVALID_FAILURETIME":
                                layer.open({
                                    content: "您的有效期已经过期，点击确认申请延长。延长有效期需要管理员确认，请耐心等待。",
                                    btn: ['确认'],
                                    yes: function (index, layero) {
                                        sendExtendValidate()
                                        layer.close(index)
                                    }
                                })
                                return;
                            default:
                                layer.alert("未在当前版本实现的功能")
                        }
                    }
                });
            });

            function sendExtendValidate() {
                $.post('/extend_failure_time', {}, function(res) {
                })
            }

            $('#send-phone-sms').click(function () {
                var phone = $('input[name="disable_phone"]').val()
                var auth_type = $(".on").data('type')

                var $that = $(this);
                if(phone.length != 11){
                    layer.msg('您的手机号格式不正确,无法获得验证码！');
                    return
                }
                if ($(this).hasClass('disabled')) {
                    return;
                }
                window.clearInterval(intervalId);
                $.post('/send-sms/', {username: phone, auth_type: auth_type}, function (res) {
                    if(!res.success){
                        layer.msg(res.message);
                        return;
                    }
                });
                sec = 59;
                $that.html(sec);
                $(this).addClass('disabled');
                intervalId = setInterval(function () {
                    counting = true;
                    $that.html(sec);
                    sec -= 1;
                    if (sec < 0) {
                        $that.removeClass('disabled');
                        counting = false;
                        $that.html('点击发送');
                    }
                }, 1000);
            });

            $('.send-sms').click(function () {
                var phone = $("#user_name").val()
                
                var auth_type = $(".on").data('type')
                

                var $that = $(this);
                if(phone.length != 11){
                    layer.msg('您的手机号格式不正确,无法获得验证码！');
                    return
                }
                if ($(this).hasClass('disabled')) {
                    return;
                }
                window.clearInterval(intervalId);
                $.post('/send-sms/', {username: phone, auth_type: auth_type}, function (res) {
                    if(!res.success){
                        layer.msg(res.message);
                        return;
                    }
                });
                sec = 59;
                $that.html(sec);
                $(this).addClass('disabled');
                intervalId = setInterval(function () {
                    counting = true;
                    $that.html(sec);
                    sec -= 1;
                    if (sec < 0) {
                        $that.removeClass('disabled');
                        counting = false;
                        $that.html('点击发送');
                    }
                }, 1000);
            });

            $('#submit_second_login').click(function () {
                var data = $("#second_login_form").serialize();
                $.ajax({
                    url: "/do-second-login",
                    data: data,
                    dataType: 'json',
                    type: 'POST',
                    success: function (res) {
                        if (res.success) {
                            layer.msg("登录成功！");
                            setTimeout(function () {
                                window.location.href = res.url;
                            }, 1000);
                        } else {
                            layer.msg(res.message);
                        }
                    }
                })
            });

            $('#submit_confirm_login').click(function () {
                var data = $("#confirm_login_form").serialize();
                $.ajax({
                    url: "/do-confirm-login",
                    data: data,
                    dataType: 'json',
                    type: 'POST',
                    success: function (res) {
                        if (res.success) {
                            layer.msg("登录成功！");
                            setTimeout(function () {
                                window.location.href = res.data
                            }, 1000);
                        }
                    }
                })
            });

            var currentCursor = 0;

            $(".login-nav-next").click(function () {
                if ($(".login-nav-scroll").width() < $(".login-nav-nav").width()) {
                    currentCursor = $(".login-nav-scroll").width() - $(".login-nav-nav").width();
                    $(".login-nav-nav").css("transform",  "translateX(" + currentCursor + "px)");
                    $(".login-nav-nav").css("-ms-transform",  "translateX(" + currentCursor + "px)");
                    $(".login-nav-nav").css("-moz-transform",  "translateX(" + currentCursor + "px)");
                    $(".login-nav-nav").css("-webkit-transform",  "translateX(" + currentCursor + "px)");
                    $(".login-nav-nav").css("-o-transform",  "translateX(" + currentCursor + "px)");
                }                
            });

            $(".login-nav-prev").click(function () {
                currentCursor = 0;
                $(".login-nav-nav").css("transform",  "translateX(" + currentCursor + "px)");
                $(".login-nav-nav").css("-ms-transform",  "translateX(" + currentCursor + "px)");
                $(".login-nav-nav").css("-moz-transform",  "translateX(" + currentCursor + "px)");
                $(".login-nav-nav").css("-webkit-transform",  "translateX(" + currentCursor + "px)");
                $(".login-nav-nav").css("-o-transform",  "translateX(" + currentCursor + "px)");
            });

            
            

            

            
            $(".login-nav-item").off("click").on("click", function () {
            
                var index = $(this).index();
                
                $(this).addClass("on").siblings().removeClass("on");
                
                if ($(this).data('type') == 'local') {
                    $('.password-field').show();
                    
                    $("#captcha-wrap").hide();
                    
                    $('.sms-field').hide();
                    $('.el-button-login').show();
                    $('input[name=auth_type]').val('local');
                    $('#user_name').parent().removeClass('phone-input');
                    $('#user_name').parent().removeClass('user-input');
                    $('#user_name').parent().addClass('user-input');
                    $('#user_name').attr('placeholder', "学工号(CampusID)");
                    $('.user-input').show();
                    $('.user-input').parent().show();
                    $('.remember-field').show();
                    $('.wechat-qrcode').hide();
                    $('.dingding-qrcode').hide();
                    $('#oidc_login').hide();
                    $('#cas_login').hide();
                    $('#more_login').hide();
                } else if ($(this).data('type') == 'auth_sms') {
                    $('.password-field').hide();
                    $('.sms-field').show();
                    $('.el-button-login').show();
                    $('.sms-wx-field').hide();
                    $('.user-input').show();
                    $('.user-input').parent().show();
                    $('input[name=auth_type]').val('auth_sms');
                    $('#user_name').parent().removeClass('user-input');
                    $('#user_name').parent().addClass('phone-input');
                    $('#user_name').attr('placeholder', "手机号");
                    $('.phone-input').show();
                    $('.phone-input').parent().show();
                    $('.remember-field').hide();
                    $('.wechat-qrcode').hide();
                    $('.dingding-qrcode').hide();
                    $('#oidc_login').hide();
                    $('#cas_login').hide();
                    $('#more_login').hide();
                }
                
                else if ($(this).data('type') == 'auth_web_wechat') {
                    
                    $('.sms-field').hide();
                    $('.sms-wx-field').hide();
                    $('.password-field').hide();
                    $('.user-input').hide();
                    $('.user-input').parent().hide();
                    $('.phone-input').hide();
                    $('.phone-input').parent().hide();
                    $('.remember-field').hide();
                    $('.el-button-login').hide();
                    $('.dingding-qrcode').hide();
                    $('#oidc_login').hide();
                    $('#cas_login').hide();
                    $('#more_login').hide();
                    $('.wechat-qrcode').show();
                    if (isMobile && hasError) {
                        window.location.href = "/login?wechat_login=true"
                    }
                    
                    else {
                        window.WwLogin({
                            "id": "wechat-qrcode",
                            "appid" : "wxc10f1e316058780e",
                            "agentid" : "1000031",
                            "redirect_uri": "https:\/\/webvpn.xmu.edu.cn\/login?wechat_login=true",
                            "state" : "STATE",
                            "href" : "https://wechat.wrdtech.com/service/public/css/a.css",
                        });
                    }
                    
                }
                
                
                
                else if ($(this).data('type') == 'more_auth') {
                    $('.sms-field').hide();
                    $('.sms-wx-field').hide();
                    $('.password-field').hide();
                    $('.user-input').hide();
                    $('.user-input').parent().show();
                    $('.phone-input').hide();
                    $('.phone-input').parent().show();
                    $('.remember-field').hide();
                    $('.el-button-login').hide();
                    $('.wechat-qrcode').hide();
                    $('.dingding-qrcode').hide();
                    $('#oidc_login').hide();
                    $('#cas_login').hide();
                    $('#more_login').show();
                } else {
                    $('.sms-field').show();
                    $('.sms-wx-field').show();
                    $('.password-field').hide();
                    $('input[name=auth_type]').val('auth_wx_sms');
                    $('#user_name').parent().removeClass('user-input');
                    $('#user_name').parent().addClass('phone-input');
                    $('#user_name').attr('placeholder', "手机号");
                    $('.phone-input').show();
                    $('.phone-input').parent().show();
                    $('.el-button-login').show();
                    $('.remember-field').hide();
                    $('.wechat-qrcode').hide();
                    $('.dingding-qrcode').hide();
                    $('#oidc_login').hide();
                    $('#cas_login').hide();
                    $('#more_login').hide();
                }
            });
            

            
            $(".login-nav-item").first().click();
            

            $('#help_mark').hover(function () {
                var display_width = getWidth() / 2 + 50;
                var display_height = getHeight() / 2;
                if (display_width <= 416) {
                    var offset = 'auto';
                } else {
                    var offset = [display_height + 'px', display_width + 'px'];
                }
                layer.open({
                    type: 1,
                    shade: 0,
                    title: false,
                    shadeClose: true,
                    closeBtn: 0,
                    offset: offset,
                    area: ['320px'],
                    content: $('#wechat_tip')
                });

            }, function () {
                layer.closeAll();
            });

        });

        
        function getWidth() {
            if (window.innerWidth) {
                winWidth = window.innerWidth;
            } else if ((document.body) && (document.body.clientWidth)) {
                winWidth = document.body.clientWidth;
            }
            if (document.documentElement && document.documentElement.clientHeight && document.documentElement.clientWidth) {
                winWidth = document.documentElement.clientWidth;
            }
            return winWidth;
        }

        
        function getHeight() {
            if (window.innerHeight) {
                winHeight = window.innerHeight;
            } else if ((document.body) && (document.body.clientHeight)) {
                winHeight = document.body.clientHeight;
            }
            if (document.documentElement && document.documentElement.clientHeight && document.documentElement.clientWidth) {
                winHeight = document.documentElement.clientHeight;
            }
            return winHeight;
        }

        function browserCheck() {
            

            var avail_browsers = ['IE11', 'Edge', 'Chrome', 'Firefox', 'Safari', 'Mobile']
            
            var isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;

            
            var isFirefox = typeof InstallTrigger !== 'undefined';

            
            var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) {
                return p.toString() === "[object SafariRemoteNotification]";
            })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));

            
            var isIE =  false || !!document.documentMode;

            
            var isEdge = !isIE && !!window.StyleMedia;

            
            var isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime || !!window.chrome.loadTimes);

            isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            if (/Macintosh/i.test(navigator.userAgent)) {
                isSafari = true;
            }
            for (var i in avail_browsers) {
                switch (avail_browsers[i]) {
                    case 'IE11':
                        if (isIE && parseInt(document.documentMode) >= 8) {
                            return true;
                        }
                        break;
                    case 'Edge':
                        if (isEdge) {
                            return true;
                        }
                        break;
                    case 'Chrome':
                        if (isChrome) {
                            return true;
                        }
                        break;
                    case 'Firefox':
                        if (isFirefox) {
                            return true;
                        }
                        break;
                    case 'Mobile':
                        if (isMobile) {
                            return true;
                        }
                        break;
                    case 'Safari':
                        if (isSafari) {
                            return true;
                        }
                }

            }
            return false;
        }

        var isMobile = false;

        var check = browserCheck()
        if (!check) {
            alert("您的浏览器无法正常打开WEBVPN界面，请更新您的浏览器")
        }
    </script>
    
    <script>
    function isWXwork(){
        var ua = navigator.userAgent.toLowerCase();
        if(ua.match(/wxwork/i)=="wxwork") {
            return true;
        } else {
            return false;
        }
    }

    if (isWXwork() && hasError) {
        
        window.location.href = "/login?wechat_login=true"
    }
    </script>
    

    
</body>
</html>
